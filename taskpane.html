<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LabelMate</title>

  <!-- Preapply theme before CSS to avoid FOUC -->
  <script>
    (function () {
      try {
        var t = localStorage.getItem('lm-theme'); // 'light' | 'dark' | 'system' | null
        if (t && t !== 'system') {
          document.documentElement.setAttribute('data-theme', t);
        } else {
          document.documentElement.removeAttribute('data-theme');
        }
      } catch (_) {}
    })();
  </script>

  <!-- Office.js -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <!-- ƒåist√© CSS -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Lep≈°√≠ render nativn√≠ch prvk≈Ø (mƒõn√≠me dynamicky v theme.js) -->
  <meta name="color-scheme" content="light dark">

  <!-- Kompat utilita: nƒõkter√© tv√© skripty schov√°vaj√≠/ukazuj√≠ .hidden -->
  <style>.hidden{display:none!important}</style>
</head>
<body>
  <div class="stack" style="max-width: 720px; margin: 0 auto; padding: 20px;">

    <!-- Banner: chybƒõj√≠c√≠ klasifikace -->
    <div id="missingBanner" class="banner warning hidden" style="position: sticky; top: 0; z-index: 10;">
      <div id="bnrTitle" class="font-semibold">Dokument nem√° nastavenou klasifikaci</div>
      <div id="bnrDesc" class="muted">Zvolte √∫rove≈à klasifikace n√≠≈æe. Po nastaven√≠ banner zmiz√≠.</div>
    </div>

    <!-- Header -->
    <header class="row" style="justify-content: space-between;">
      <h1 id="appTitle" style="margin: 0;">LabelMate for Word</h1>

      <div class="row">
        <!-- P≈ôep√≠naƒç motivu ‚Äì cykluje: Svƒõtl√Ω ‚Üí Tmav√Ω ‚Üí Syst√©m -->
        <button id="theme-toggle" class="btn theme-toggle" title="P≈ôepnout motiv">
          <span class="icon" aria-hidden="true">üñ•Ô∏è</span>
          <span class="state">Syst√©m</span>
        </button>
      </div>
    </header>

    <!-- Jazyk -->
    <section class="row" style="gap: 12px;">
      <label for="langSelect" id="langLabel">Jazyk</label>
      <select id="langSelect" style="max-width: 220px;">
        <option value="AUTO">Auto</option>
        <option value="EN">English</option>
        <option value="CZ">ƒåe≈°tina</option>
        <option value="SK">Slovenƒçina</option>
      </select>
      <span id="langStatus" class="muted" style="font-size: 12px;"></span>
    </section>

    <!-- Klasifikace -->
    <section class="stack">
      <p id="choosePrompt" style="margin: 0;">Zvolte √∫rove≈à klasifikace:</p>
      <div id="labelsContainer" class="stack"></div>
    </section>

    <!-- Stavov√° linka -->
    <div id="status" role="status" aria-live="polite" class="muted" style="font-weight: 600;"></div>
  </div>

  <!-- Skripty (po≈ôad√≠ zachov√°no) -->
  <script src="theme.js"></script>
  <script src="i18n.js"></script>
  <script src="core.js"></script>
  <script src="banner.js"></script>
  <script src="labels.js"></script>
  <script src="app.js"></script>
</body>
</html>
