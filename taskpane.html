<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LabelMate</title>

  <!-- Preapply theme (jen 'light' | 'dark'); pokud nic ulo≈æeno, zvol OS preferenci -->
  <script>
    (function () {
      try {
        var t = localStorage.getItem('lm-theme'); // 'light' | 'dark' | null
        if (!t) {
          var prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          t = prefersDark ? 'dark' : 'light';
        }
        document.documentElement.setAttribute('data-theme', t);
      } catch (_) {}
    })();
  </script>

  <!-- Office.js -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <!-- ƒåist√© CSS -->
  <link rel="stylesheet" href="styles.core.css" />
  <link rel="stylesheet" href="styles.components.css" />
  <link rel="stylesheet" href="styles.ui.css" />


  <!-- Nativn√≠ prvky ‚Äì nastavujeme i v theme.js -->
  <meta name="color-scheme" content="light dark">

  <style>.hidden{display:none!important}</style>
</head>
<body>
  <div class="stack" style="max-width: 720px; margin: 0 auto; padding: 20px;">

    <div id="missingBanner" class="banner warning hidden" style="position: sticky; top: 0; z-index: 10;">
      <div id="bnrTitle" class="font-semibold">Dokument nem√° nastavenou klasifikaci</div>
      <div id="bnrDesc" class="muted">Zvolte √∫rove≈à klasifikace n√≠≈æe. Po nastaven√≠ banner zmiz√≠.</div>
    </div>

    <header class="row" style="justify-content: space-between;">
      <h1 id="appTitle" style="margin: 0;">LabelMate for Word</h1>

      <div class="row">
        <!-- Ikonkov√© tlaƒç√≠tko (bez textu) -->
        <button id="theme-toggle" class="btn icon theme-toggle" title="Toggle theme" aria-label="Toggle theme">
          <span class="icon" aria-hidden="true">üñ•Ô∏è</span>
        </button>
      </div>
    </header>

    <section class="row" style="gap: 12px;">
      <label for="langSelect" id="langLabel">Jazyk</label>
      <select id="langSelect" style="max-width: 220px;">
        <option value="AUTO">Auto</option>
        <option value="EN">English</option>
        <option value="CZ">ƒåe≈°tina</option>
        <option value="SK">Slovenƒçina</option>
      </select>
      <span id="langStatus" class="muted" style="font-size: 12px;"></span>
    </section>

    <section class="stack">
      <p id="choosePrompt" style="margin: 0;">Zvolte √∫rove≈à klasifikace:</p>
      <div id="labelsContainer" class="stack"></div>
    </section>

    <div id="status" role="status" aria-live="polite" class="muted" style="font-weight: 600;"></div>
  </div>

  <!-- Skripty -->
  <script src="theme.js"></script>
  <script src="i18n.js"></script>
  <script src="core.js"></script>
  <script src="banner.js"></script>
  <script src="labels.js"></script>
  <script src="app.js"></script>
</body>
</html>
